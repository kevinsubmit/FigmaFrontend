# 开发更新（2026-02-13）手机号注册/登录兼容规范

## 目标
统一手机号规范化逻辑，确保用户输入手机号时：
- 带前导国家码 `1` 与不带前导 `1` 都能正常注册/登录；
- 同时避免错误的 11 位号码被误接收。

## 实现内容

### 1. 新增统一手机号规范化函数
- 新增文件：`backend/app/schemas/phone.py`
- 函数：`normalize_us_phone(raw_phone, error_message)`
- 规则：
  - 输入 10 位数字：自动补前导 `1`，存为 11 位；
  - 输入 11 位数字：必须以 `1` 开头；
  - 其它格式：直接报错。

### 2. 注册/登录统一使用同一规则
- 修改：`backend/app/schemas/user.py`
- `UserBase.phone` 与 `UserLogin.phone` 的校验器都改为调用 `normalize_us_phone`。

### 3. 验证码流程统一使用同一规则
- 修改：`backend/app/schemas/verification.py`
- `SendVerificationCodeRequest.phone` 与 `VerifyCodeRequest.phone` 的校验器都改为调用 `normalize_us_phone`。

## 结果
- `1231231234` 与 `11231231234` 均可登录同一账号（按统一格式匹配）。
- 发验证码时，`4155550199` 与 `14155550199` 均可正常发送。
- 无效 11 位（不以 `1` 开头）会被拒绝，避免脏数据。

## 影响范围
- H5 前台登录/注册
- 后台登录
- 验证码发送与校验

