# 2026-02-17 积分兑换与优惠券核销体验更新

## 本次目标
- 让运营可在后台直接配置“积分兑换优惠券”门槛。
- 让 H5 用户在 `My Points` 页面可直接兑换优惠券。
- 明确 `My Coupons` 里的按钮用途，避免误解为前端直接核销。
- 去掉 Profile 页面对固定兑换比例的误导文案。

## 后台管理更新（Coupons）
文件：`admin-dashboard/src/pages/Coupons.tsx`

1. 模板创建支持配置积分兑换门槛
- 新增字段：`Points Required (optional)`
- 留空：不可积分兑换
- 填写整数（>=1）：可被积分兑换

2. 模板编辑支持修改积分兑换门槛
- 编辑弹窗新增同字段：`Points Required (optional)`

3. 模板列表展示兑换门槛
- 新增列：`Points Req`
- 便于运营直接查看哪些模板支持积分兑换

## H5 前端更新

### 1) My Points 增加兑换入口
文件：`frontend/src/components/MyPoints.tsx`

- 新增 `EXCHANGE COUPONS` 区块
- 拉取可兑换模板并展示兑换按钮 `Exchange`
- 显示每张券所需积分与最低消费
- 兑换后自动刷新积分与列表

### 2) Profile 去掉固定比例文案
文件：`frontend/src/components/Profile.tsx`

- 移除 `100 pts = $5 Discount` 文案
- 原因：兑换比例不是写死，按优惠券模板配置

### 3) My Coupons 的“Use”按钮改为门店核销引导
文件：`frontend/src/components/MyCoupons.tsx`

- `Use` 改为 `Show to Staff`
- 展示 `User Coupon ID`，并支持一键复制
- 点击后弹出提示：到店出示该 ID，由后台结算核销

## 业务规则说明
1. 积分兑换比例不是全局固定值。
2. 每张优惠券模板可独立配置：
- 券面额：`discount_value`
- 兑换门槛：`points_required`
3. 优惠券“used”状态由后台结算核销时产生，不在 H5 端直接改状态。

## 验证
- `admin-dashboard` 构建通过
- `frontend` 构建通过（保留既有 chunk size warning，不影响功能）
