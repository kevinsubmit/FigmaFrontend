# 开发收尾（2026-02-09）：首页图片流与 H5 搜索

## 一、今日完成的核心能力

### 1) 首页图片流后台化（超管）
- 新增 `Home Feed` 管理入口（仅超管可见）
- 支持图片上传、编辑、软删除、状态管理（draft/published/offline）
- 支持分类多选绑定（一图多分类）
- 分类由超管维护（新增/编辑/停用）

### 2) 首页标签展示可控
- `All` 固定保留
- 其它标签由超管控制是否显示（`show_on_home`）
- 超管可调整标签展示顺序（上移/下移，落库为 `sort_order`）

### 3) 节日专题模式
- 支持“首页专题分类”配置（如 Christmas）
- 支持启用开关 + 起止时间
- 生效时，H5 首页默认只展示该专题分类图片

### 4) H5 首页加载与稳定性优化
- 首次加载 `12` 张
- 每次下拉加载 `8` 张
- 删除图片后，首页缓存会后台同步，避免旧图残留
- 图片地址失效时回退默认图，避免空白卡片

### 5) H5 搜索逻辑修复（按你的要求）
- 搜索仅在“用户确认”后触发：
  - 按 Enter
  - 点击搜索图标
- 搜索改为“仅按图片标题匹配”
- 修复 query 参数丢失问题（之前导致看起来像“随便搜都返回全部”）
- 搜索文案改为英文，适配美国用户

## 二、关键接口行为（当前）
- `GET /api/v1/pins/tags`
  - 仅返回 `is_active=true && show_on_home=true` 的分类
- `GET /api/v1/pins`
  - 返回 `published && !is_deleted` 图片
  - `search` 仅按 `title` 匹配
  - 专题模式生效时，未传 `tag` 会自动按专题分类过滤

## 三、已完成验证
- 后端迁移执行通过
- admin-dashboard 构建通过
- frontend 构建通过
- 关键路径烟测通过：
  - 分类隐藏后不出现在 H5 标签
  - 标签排序可自定义
  - 搜索按标题生效

## 四、备注
- 本地开发过程中的 `__pycache__`、`.env`、本地数据库文件未纳入功能提交。
- 今日相关代码变更已全部推送至 `origin/main`。
